<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >

<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<title> Otaku, Cedric&#039;s blog</title>

<link rel="alternate" type="application/rss+xml" title="Otaku, Cedric&#039;s blog RSS Feed" href="http://beust.com/weblog/feed/" />
<link rel="alternate" type="application/atom+xml" title="Otaku, Cedric&#039;s blog Atom Feed" href="http://beust.com/weblog/feed/atom/" />
<link rel="pingback" href="http://beust.com/weblog/xmlrpc.php" />
<link rel="shortcut icon" href="http://beust.com/weblog/wp-content/themes/arclite/favicon.ico" />


<style type="text/css">
@import "http://beust.com/weblog/wp-content/themes/arclite/style.css";
@import "http://beust.com/weblog/wp-content/themes/arclite/options/side-default.css";
@import "http://beust.com/weblog/wp-content/themes/arclite/options/content-default.css";
@import "http://beust.com/weblog/wp-content/themes/arclite/options/header-default.css";
.post-content {
  font-size: 120%;
}


</style>
<!--[if lte IE 6]>
<style type="text/css" media="screen">
 @import "http://beust.com/weblog/wp-content/themes/arclite/ie6.css";
</style>
<![endif]-->

 <link rel='stylesheet' id='cptch_stylesheet-css'  href='http://beust.com/weblog/wp-content/plugins/captcha/css/style.css?ver=4.1.5' type='text/css' media='all' />
<!-- This site uses the Google Analytics by Yoast plugin v5.3.3 - Universal enabled - https://yoast.com/wordpress/plugins/google-analytics/ -->
<script type="text/javascript">
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');

	__gaTracker('create', 'UA-238215-1', 'auto');
	__gaTracker('set', 'forceSSL', true);
	__gaTracker('send','pageview');

</script>
<!-- / Google Analytics by Yoast -->
<script type='text/javascript' src='http://beust.com/weblog/wp-content/plugins/wp-plus-one/wp-plus-one.js?ver=4.1.5'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://beust.com/weblog/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://beust.com/weblog/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 4.1.5" />


        <link type="text/css" rel="stylesheet" href="http://beust.com/beust.css"  />

      <script type="text/javascript" src="http://beust.com/scripts/shCore.js"></script>
      <script type="text/javascript" src="http://beust.com/scripts/shBrushBash.js"></script>
      <script type="text/javascript" src="http://beust.com/scripts/shBrushCpp.js"></script>
      <script type="text/javascript" src="http://beust.com/scripts/shBrushJava.js"></script>
      <script type="text/javascript" src="http://beust.com/scripts/shBrushPlain.js"></script>
      <script type="text/javascript" src="http://beust.com/scripts/shBrushRuby.js"></script>
      <script type="text/javascript" src="http://beust.com/scripts/shBrushScala.js"></script>
      <script type="text/javascript" src="http://beust.com/scripts/shBrushXml.js"></script>
      <script type="text/javascript" src="http://beust.com/scripts/shBrushPython.js"></script>
      <script type="text/javascript" src="http://beust.com/scripts/shBrushJScript.js"></script>
      <link type="text/css" rel="stylesheet" href="http://beust.com/styles/shCore.css"/>
      <link type="text/css" rel="stylesheet" href="http://beust.com/styles/shThemeCedric.css"/>

      <script type="text/javascript">
        SyntaxHighlighter.config.clipboardSwf = 'scripts/clipboard.swf';
        SyntaxHighlighter.defaults['gutter'] = false;
        SyntaxHighlighter.all();
      </script>


<!--
<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/default.min.css">
<script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
-->

</head>
<body class="home">
 <!-- page wrap -->
 <div id="page" class="with-sidebar">

  <!-- header -->
  <div id="header-wrap">
   <div id="header" class="block-content">
     <div id="pagetitle">

            <h1 class="logo"><a href="http://beust.com/weblog/">Otaku, Cedric&#039;s blog</a></h1>
      
      <h4>Thoughts about software development</h4>      <div class="clear"></div>

      
     </div>

     <!-- main navigation -->
     <div id="nav-wrap1">
      <div id="nav-wrap2">
        <ul id="nav">
                     <li id="nav-homelink" class="current_page_item"><a class="fadeThis" href="http://beust.com/weblog" title="You are Home"><span>Home</span></a></li>
                    <li class="page_item page-item-703"><a class="fadeThis" href="http://beust.com/weblog/about-2/"><span>About</span></a></li>
        </ul>
      </div>
     </div>
     <!-- /main navigation -->

   </div>
  </div>
  <!-- /header -->
<!-- main wrappers -->
<div id="main-wrap1">
 <div id="main-wrap2">

  <!-- main page block -->
  <div id="main" class="block-content">
   <div class="mask-main rightdiv">
    <div class="mask-left">

     <!-- first column -->
     <div class="col1">
      <div id="main-content">

              
        <!-- post -->
        <div id="post-2877" class="post-2877 post type-post status-publish format-standard hentry category-android category-kotlin">

          <div class="post-header">
           <h3 class="post-title"><a href="http://beust.com/weblog/2015/05/12/anko-for-android/" rel="bookmark" title="Permanent Link: Anko for Android">Anko for Android</a></h3>
           <p class="post-date">
            <span class="month">May</span>
            <span class="day">12</span>
           </p>
           <p class="post-author">
            <span class="info">Posted by <a href="http://beust.com/weblog/author/admin/" title="Posts by Cedric ">Cedric</a> in <a href="http://beust.com/weblog/category/android/" rel="category tag">Android</a>, <a href="http://beust.com/weblog/category/kotlin/" rel="category tag">Kotlin</a> | <a href="http://beust.com/weblog/2015/05/12/anko-for-android/#respond" class="comments"  title="Comment on Anko for Android">No Comments</a>              </span>
           </p>
          </div>

          <div class="post-content clearfix">
          <p>I&#8217;m really excited to see JetBrains continue to invest in Android. Not long ago, they release <a href="https://github.com/JetBrains/anko" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://github.com/JetBrains/anko', 'Anko');">Anko</a>, a library that uses Kotlin&#8217;s DSL functionalities to offer a different way to define your layouts than XML:</p>
<pre class="brush:java">
verticalLayout {
    val name = editText()
    button("Say Hello") {
        onClick { toast("Hello, ${name.text}!") }
    }
}
</pre>
<p>To be honest, I&#8217;m still a bit skeptical of the value that such a DSL provides for layout definitions (the XML file based layout that Android supports is extremely flexible to manage layouts for different displays) but JetBrains just released <a href="http://blog.jetbrains.com/kotlin/2015/05/advanced-features-of-anko/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://blog.jetbrains.com/kotlin/2015/05/advanced-features-of-anko/', 'a new version of Anko');">a new version of Anko</a> and the direction this library is taking is now becoming much more interesting to me.</p>
<p>With the latest additions, Anko is widening its scope beyond layout definition and adding a set of helper functions that make Android development on Kotlin even cleaner and more concise. The combination of extension functions and the DSL notation really shine for Android development. Here are a few examples:</p>
<pre class="brush:java">
val flowers = listOf("Chrysanthemum", "Rose", "Hyacinth")
selector("What is your favorite flower?", flowers) { i ->
    toast("So your favorite flower is ${flowers[i]}, right?")
}
</pre>
<p>Doing away with the pesky <tt>TAG</tt> requirement for logging:</p>
<pre class="brush:java">
class SomeActivity : Activity(), AnkoLogger {
    fun someMethod() {
        info("Info message")
        debug(42) // .toString() method will be called automatically
    }
}
</pre>
<p>Check out the <a href="http://blog.jetbrains.com/kotlin/2015/05/advanced-features-of-anko/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://blog.jetbrains.com/kotlin/2015/05/advanced-features-of-anko/', 'announcement');">announcement</a> for more snippets, or head directly to <a href="http://blog.jetbrains.com/kotlin/2015/05/advanced-features-of-anko/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://blog.jetbrains.com/kotlin/2015/05/advanced-features-of-anko/', 'Anko&#8217;s project page');">Anko&#8217;s project page</a>.</p>
<p>
<div class="wp_plus_one_button" style="margin: 0 8px 8px 0; float:left; "><g:plusone href="http://beust.com/weblog/2015/05/12/anko-for-android/" callback="wp_plus_one_handler"></g:plusone></div>
                    </div>

        </div>
        <!-- /post -->


       
        <!-- post -->
        <div id="post-2865" class="post-2865 post type-post status-publish format-standard hentry category-general">

          <div class="post-header">
           <h3 class="post-title"><a href="http://beust.com/weblog/2015/05/03/the-case-of-the-buggy-executor/" rel="bookmark" title="Permanent Link: The case of the buggy executor">The case of the buggy executor</a></h3>
           <p class="post-date">
            <span class="month">May</span>
            <span class="day">3</span>
           </p>
           <p class="post-author">
            <span class="info">Posted by <a href="http://beust.com/weblog/author/admin/" title="Posts by Cedric ">Cedric</a> in <a href="http://beust.com/weblog/category/general/" rel="category tag">General</a> | <a href="http://beust.com/weblog/2015/05/03/the-case-of-the-buggy-executor/#comments" class="comments"  title="Comment on The case of the buggy executor">8 Comments</a>              </span>
           </p>
          </div>

          <div class="post-content clearfix">
          <p>I spent a mystifying half hour chasing down a bug recently, so I thought I would share.</p>
<p>Here is a simple scheduled executor:</p>
<pre class="brush:java">
public class Exec {
    final static Logger logger = LoggerFactory.getLogger(Exec.class);

    private static final ScheduledExecutorService executor =
        Executors.newSingleThreadScheduledExecutor(
            new ThreadFactory() {
                @Override
                public Thread newThread(Runnable r) {
                    Thread result = new Thread();
                    result.setName("BuggyExecutor");
                    return result;
                }
            });

    public static void main(String[] args) {
        executor.scheduleAtFixedRate(() -> logger.info("Tick"),
                0,
                1, TimeUnit.SECONDS);
    }
}
</pre>
<p>I always use a <tt>ThreadFactory</tt> in my executors since seeing thread names plainly in your trace simplifies debugging threading issues considerably. Whenever I see a <tt>pool-2-thread-3</tt> in my thread dump, I track down the lazy library that caused that monstrosity and I seriously consider replacing it with one that is written by developers more respectful of my time.</p>
<p>Other than that, this code is pretty straightforward and if you run it, you would expect the string &#8220;Tick&#8221; to be displayed every second:</p>
<pre class="brush:plain">
17:37:18.780 [BuggyExecutor] INFO  com.beust.Exec - Tick
17:37:19.780 [BuggyExecutor] INFO  com.beust.Exec - Tick
17:37:20.780 [BuggyExecutor] INFO  com.beust.Exec - Tick
</pre>
<p>However, if you run the code as provided above, you will see that it does absolutely nothing.</p>
<p>
<div class="wp_plus_one_button" style="margin: 0 8px 8px 0; float:left; "><g:plusone href="http://beust.com/weblog/2015/05/03/the-case-of-the-buggy-executor/" callback="wp_plus_one_handler"></g:plusone></div>
                    </div>

        </div>
        <!-- /post -->


       
        <!-- post -->
        <div id="post-2859" class="post-2859 post type-post status-publish format-standard hentry category-general">

          <div class="post-header">
           <h3 class="post-title"><a href="http://beust.com/weblog/2015/05/02/your-code-doesnt-speak-for-itself/" rel="bookmark" title="Permanent Link: Your code doesn&#8217;t speak for itself">Your code doesn&#8217;t speak for itself</a></h3>
           <p class="post-date">
            <span class="month">May</span>
            <span class="day">2</span>
           </p>
           <p class="post-author">
            <span class="info">Posted by <a href="http://beust.com/weblog/author/admin/" title="Posts by Cedric ">Cedric</a> in <a href="http://beust.com/weblog/category/general/" rel="category tag">General</a> | <a href="http://beust.com/weblog/2015/05/02/your-code-doesnt-speak-for-itself/#comments" class="comments"  title="Comment on Your code doesn&#8217;t speak for itself">4 Comments</a>              </span>
           </p>
          </div>

          <div class="post-content clearfix">
          <p>I recently reviewed a commit that said &#8220;Fix the list view bug&#8221;. I reviewed it, saw that it was fixing an off-by-one error, approved it and moved on.</p>
<p>A few days later, another commit went by that said &#8220;Really fix the list view bug&#8221;. This fix was a bit more involved and caused the first item in the list view to sometimes receive the wrong styling. I then realized that I shouldn&#8217;t have approved the first commit without asking a few more questions.</p>
<p>Here is another scenario. Let&#8217;s say you are asked to review the following code:</p>
<pre class="brush:java">
public static int compare(@Nonnull Long a, @Nonnull Long b) {
	return a.compareTo(b);
}
</pre>
<p>Seems pretty harmless, doesn&#8217;t it? No reason not to approve it.</p>
<p>How about this one:</p>
<pre class="brush:java">
/**
 * @return 0 if the two numbers are equal, 1 otherwise.
 */
public int cmp(@Nonnull Long a, @Nonnull Long b) {
	return a.compareTo(b);
}
</pre>
<p>Now we have a problem: the code and the comment do not agree. This should not be approved before asking the developer to fix this (either change the comment or change the code).</p>
<p>There is this prevalent notion in the software world that good code doesn&#8217;t need comments, that it stands on its own. Or that comments are a code smell.</p>
<p>Irritatingly, this myth just won&#8217;t die despite repeated evidence that comments are sometimes vital to code correctness. Proponents of this myth point out that it&#8217;s easy for comments to get out of sync with the code (see the example above) and decide that because this approach is not perfect, it should be avoided altogether.</p>
<p>This is a false dichotomy that is easily avoided by making it clear to your teammates that both code and comments need to be reviewed.</p>
<p>The problem with the first example that I gave is that the developer failed to disclose what the intent of his code was. The code type checks, is correct and fixes a bug, but it turns out to be doing something different than the developer intended, and the reviewer would have caught it if the developer had explained what the intent of his code is.</p>
<p>Not all code needs comments, but certain pieces of code are useless and can&#8217;t be verified without comments. </p>
<p>Your code says &#8220;What?&#8221;, your comments say &#8220;Why?&#8221;. Sometimes, you need both in order to assess the correctness of a commit. Just make sure you review comments as seriously as you review code.</p>
<p>
<div class="wp_plus_one_button" style="margin: 0 8px 8px 0; float:left; "><g:plusone href="http://beust.com/weblog/2015/05/02/your-code-doesnt-speak-for-itself/" callback="wp_plus_one_handler"></g:plusone></div>
                    </div>

        </div>
        <!-- /post -->


       
        <!-- post -->
        <div id="post-2838" class="post-2838 post type-post status-publish format-standard hentry category-android category-kotlin category-rx">

          <div class="post-header">
           <h3 class="post-title"><a href="http://beust.com/weblog/2015/04/11/android-rx-and-kotlin-part-3/" rel="bookmark" title="Permanent Link: Android, Rx and Kotlin: part 3">Android, Rx and Kotlin: part 3</a></h3>
           <p class="post-date">
            <span class="month">Apr</span>
            <span class="day">11</span>
           </p>
           <p class="post-author">
            <span class="info">Posted by <a href="http://beust.com/weblog/author/admin/" title="Posts by Cedric ">Cedric</a> in <a href="http://beust.com/weblog/category/android/" rel="category tag">Android</a>, <a href="http://beust.com/weblog/category/kotlin/" rel="category tag">Kotlin</a>, <a href="http://beust.com/weblog/category/rx/" rel="category tag">Rx</a> | <span class="comments">Comments off</span>              </span>
           </p>
          </div>

          <div class="post-content clearfix">
          <p align="center">
	<img src="http://beust.com/pics/prestige.jpg" </img>
</p>
<p>This is part three of my Rx &#8211; Android &#8211; Kotlin series (<a href="http://beust.com/weblog/2015/03/23/android-rx-and-kotlin-a-case-study/">part 1</a>, <a href="http://beust.com/weblog/2015/04/05/android-rx-and-kotlin-part-2/">part 2</a>).</p>
<p>This article has three parts, <a href="http://www.imdb.com/title/tt0482571/quotes?item=qt0441491" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.imdb.com/title/tt0482571/quotes?item=qt0441491', 'much like a magic trick');">much like a magic trick</a>:</p>
<ul>
<li>The Pledge: we will implement a simple GUI operation with Rx and Kotlin on Android.
<li>The Turn: we will create a brand new Rx operator.
<li>The Prestige: we will use a standard feature of Kotlin for a final <em>coup de gr&acirc;ce</em> in code elegance.
</ul>
<p>Let&#8217;s get started.</p>
<h2>The Pledge</h3>
<p>We want to detect triple taps. There are various ways to define what a triple tap is so let&#8217;s just settle on a simple one: three taps are considered a triple tap if the first and last tap are separated by less than five hundred milliseconds.</p>
<p>With a traditional (non Rx) implementation, you would probably have two fields maintaining the timestamps of two taps ago <tt>[t-2]</tt> and that from one tap ago <tt>[t-1]</tt>. When a new tap arrives, <tt>[t]</tt>, you compare the timestamp of <tt>[t]</tt> and <tt>[t-2]</tt> and if it&#8217;s less than five hundred milliseconds, we have a triple tap. Then you shift down the timestamps: <tt>[t-2]</tt> receives <tt>[t-1]</tt> and <tt>[t-1]</tt> receives the current timestamp. Repeat.</p>
<p>This approach is pretty standard but it&#8217;s also ugly: it bleeds state into your class and it allows for little flexibility in terms of filtering, transforming and composing.</p>
<p>Let&#8217;s look at this problem from an Rx perspective.</p>
<h2>The Turn</h2>
<p>As I explained in the first article of this series, we need to change our perspective to find out how to implement this with Rx. We are now looking for emitters and consumers of events.</p>
<p>The emitter is pretty obvious: it&#8217;s a tap. On Android, we can just create an <tt>Observable</tt> from a <tt>View</tt> with the convenient <a href="https://github.com/ReactiveX/RxAndroid" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://github.com/ReactiveX/RxAndroid', 'RxAndroid project');">RxAndroid project</a>. Once we receive the tap events from the view, we need to use an operator which will pass them in sets of threes. This is sometimes referred to as a &#8220;sliding window&#8221;. For example, if you have an <tt>Observable</tt> that emits the numbers from 0 to 5, you would expect a sliding window of size 3 to receive the following parameters:</p>
<pre class="brush:plain">
[0, 1, 2]
[1, 2, 3]
[2, 3, 4]
[3, 4, 5]
</pre>
<p>Any list that is not of size three is ignored. Then, whenever our operator is notified, we simply extract the timestamps of the first and last index of that list and we see if the difference is less than five hundred milliseconds.</p>
<p>For the sake of learning, we&#8217;ll assume that such an operator doesn&#8217;t already exist and we&#8217;ll implement it ourselves (as it turns out, this is not true, jump to the bottom of this article if you want to find out).</p>
<h2>Implementing an Rx operator</h2>
<p>I don&#8217;t want to dive too deep into the internals of how Rx works so I&#8217;ll just focus on the important parts here. Fundamentally, an operator is like a <tt>Callable</tt>: it receives parameters and it returns a value. That value is a <tt>Subscriber</tt> which needs to implement methods you are probably familiar with now after a few hours spent on Rx: <tt>onNext()</tt>, <tt>onCompleted()</tt> and <tt>onError()</tt>.</p>
<p>We&#8217;re just going to focus on <tt>onNext()</tt> for now in order to keep this article short and because this is where our main logic resides. The implementation is pretty simple:</p>
<pre class="brush:java">
class SwSubscriber&lt;T&gt; (val child: Subscriber&lt;in List&lt;T&gt;&gt;, val size: Int)
        : Subscriber&lt;T&gt;(child)
{
    val buffer = ArrayList&lt;T&gt;(size)

    override fun onNext(t: T) {
        buffer.add(t)
        if (buffer.size() == size) {
            child.onNext(ArrayList(buffer))
            buffer.remove(0)
        }
    }

    override fun onCompleted() { /* ... */ }

    override fun onError(e: Throwable?) { /* ... */ }
}
</pre>
<p>We maintain a buffer of size three and we accumulate the elements from the <tt>Observable</tt> in it. When that buffer reaches the size three, we emit it and we shift the buffer. Note that when I call <tt>onNext()</tt> on the buffer, I pass a copy of the list and not the list itself. This is just a precaution against the fact that the subscriber might decide to alter the list I pass them, which would break our operator.</p>
<p>Now that we have a subscriber, we can create our operator:</p>
<pre class="brush:java">
class SwOperator&lt;T&gt;(val n: Int) : Observable.Operator&lt;List&lt;T&gt;, T&gt; {
    override fun call(child: Subscriber&lt;in List&lt;T&gt;&gt;): Subscriber&lt;in T&gt;? =
            SwSubscriber(child, n)
}
</pre>
<p>And this is how we use it:</p>
<pre class="brush:java">
Observable.just(1, 2, 3, 4, 5)
    .lift(SwOperator(3))
    .subscribe { println("Received ${it}") }
</pre>
<p>&#8230; which prints:</p>
<pre class="brush:plain">
Received [1, 2, 3]
Received [2, 3, 4]
Received [3, 4, 5]
</pre>
<h2>The Prestige</h2>
<p>We&#8217;re not quite done yet: you might have noticed that because our new function is, obviously, not part of the <tt>Observable</tt> class, we need to use a helper method called <tt>lift()</tt> in order to insert our code in a composition chain. Of course, we can always send a pull request to the project to have our new operator added, but we don&#8217;t have to wait: we can define an extension method in Kotlin to do just that:</p>
<pre class="brush:java">
fun &lt;T&gt; Observable&lt;T&gt;.slidingWindow(n: Int) =
    lift(SwOperator(n))
</pre>
<p>And now we can write:</p>
<pre class="brush:java">
Observable.just(1, 2, 3, 4, 5)
    .slidingWindow(3))
    .subscribe { println("Received ${it}")
</pre>
<p>Our new operator looks just as if it were part of the Rx library.</p>
<h2>Android</h2>
<p>Let&#8217;s close the loop on the initial problem so we can move on to more interesting things: now we want to use our sliding window to report triple taps.</p>
<p>Using RxAndroid, we have the convenient <tt>clicks()</tt> method that turns taps from a <tt>View</tt> into a stream of events. Unfortunately, these events are simple wrappers that don&#8217;t carry with them the timestamp of the tap, but that&#8217;s not really a problem: we just need to convert our stream of events into a stream of timestamps and we can add our logic then:</p>
<pre class="brush:java">
    ViewObservable.clicks(view)
	    .map { System.currentTimeMillis() }
	    .slidingWindow(3)
        .filter { it.get(2) - it.get(0) &lt; 500 }
        .subscribe { println("Triple tap!") }
)

</pre>
<p>This is another example of the power of composition: no need to create our own events or our own wrappers. When you look at problems in the form of streams of data that you can transform at will, a lot of problems become trivial.</p>
<h2>Rx and the sliding window</h2>
<p>Note that Rx already has the functionality we implemented in this article: it&#8217;s called <tt>buffer()</tt> and you pass it not just the window size but also by how many elements you want to skip. <tt>buffer()</tt> behaves a bit differently from our implementation, though, by notifying subscribers of windows that are smaller than the desired size:</p>
<pre class="brush:java">
        Observable.just(1, 2, 3, 4, 5)
            .buffer(3, 1)
            .subscribe { p("Received ${it}")
</pre>
<p>prints:</p>
<pre class="brush:plain">
[main] Received [1, 2, 3]
[main] Received [2, 3, 4]
[main] Received [3, 4, 5]
[main] Received [4, 5]
[main] Received [5]
</pre>
<h2>Wrapping up</h2>
<p>The concept of a sliding window is very common in all domains. Detecting multiple taps in a user interface is an example but you could also conceive using this to determine the bounding box of multiple taps. Stepping out from the graphical domain, your stream could contain geo locations and you could use the sliding window to determine instant or average speed. A few years ago, I actually posed <a href="http://beust.com/weblog/2012/09/02/coding-challenge-a-sliding-window-map/">a coding challenge to implement a sliding window in order to throttle calls to a server</a>. Needless to say, I would use Rx for this today.</p>
<p>Hopefully, this article gave you some insight on the benefits that Rx can bring to your application, regardless of the domain. Revisiting problems with the Rx philosophy is always an interesting exercise which often results in simpler, more elegant solutions.</p>
<p>Read <a href="http://beust.com/weblog/2015/03/23/android-rx-and-kotlin-a-case-study/">part 1</a>, <a href="http://beust.com/weblog/2015/04/05/android-rx-and-kotlin-part-2/">part 2</a>.</p>
<div class="wp_plus_one_button" style="margin: 0 8px 8px 0; float:left; "><g:plusone href="http://beust.com/weblog/2015/04/11/android-rx-and-kotlin-part-3/" callback="wp_plus_one_handler"></g:plusone></div>
                    </div>

        </div>
        <!-- /post -->


       
        <!-- post -->
        <div id="post-2829" class="post-2829 post type-post status-publish format-standard hentry category-general">

          <div class="post-header">
           <h3 class="post-title"><a href="http://beust.com/weblog/2015/04/05/android-rx-and-kotlin-part-2/" rel="bookmark" title="Permanent Link: Android, Rx and Kotlin: part 2">Android, Rx and Kotlin: part 2</a></h3>
           <p class="post-date">
            <span class="month">Apr</span>
            <span class="day">5</span>
           </p>
           <p class="post-author">
            <span class="info">Posted by <a href="http://beust.com/weblog/author/admin/" title="Posts by Cedric ">Cedric</a> in <a href="http://beust.com/weblog/category/general/" rel="category tag">General</a> | <a href="http://beust.com/weblog/2015/04/05/android-rx-and-kotlin-part-2/#comments" class="comments"  title="Comment on Android, Rx and Kotlin: part 2">2 Comments</a>              </span>
           </p>
          </div>

          <div class="post-content clearfix">
          <p>I haven&#8217;t been quite honest with you <a href="http://beust.com/weblog/2015/03/23/android-rx-and-kotlin-a-case-study/">my previous post</a>: the code I showed in the article doesn&#8217;t exactly result in the short video of the application at the top of the article.</p>
<p>If you run the code as is, you will notice something very irritating (and unacceptable in any application): whenever the app is pretending to make a network call, the entire user interface freezes for a second. You can&#8217;t type anything and the loading icon stops spinning. This is the classic symptom of blocking the main thread. You will remember that I am simulating network calls by simply sleeping for a little while, and obviously, if you do this on the main thread, you will freeze your UI.</p>
<p>By default, Rx runs everything on your current thread, which is the main thread in Android:  the thread that is in charge of updating your user interface. Android is exactly like most graphical toolkits: you should only use the main thread to update your UI but anything else you do (network or file system access, computations, database updates, etc&#8230;) needs to be done on a background thread. Rx has a very good solution to this problem.</p>
<h2>Threading</h2>
<p>Until recently, <a href="http://developer.android.com/reference/android/os/AsyncTask.html" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://developer.android.com/reference/android/os/AsyncTask.html', 'AsyncTask');"><tt>AsyncTask</tt></a> was the recommended way of performing this kind of task: by creating and executing an <tt>AsyncTask</tt>, you can run your code in two locations, one that will be run in a background thread (<tt>doInBackground()</tt>) and once that task completes, code that will run on the main thread (<tt>onPostExecute()</tt>).</p>
<p><tt>AsyncTask</tt> has a troubled past and it has evolved quite a bit over the many revisions of the Android API: first it was single threaded, then it became multithreaded and more recently, it&#8217;s running in the background on one thread in an attempt to provide both parallelism and sequencing at the same time. If you need more information about <tt>AsyncTask</tt>, <a href="http://bon-app-etit.blogspot.com/2013/04/the-dark-side-of-asynctask.html" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://bon-app-etit.blogspot.com/2013/04/the-dark-side-of-asynctask.html', 'this article explains how it evolved');">this article explains how it evolved</a>.</p>
<p>This is not the only issue with <tt>AsyncTask</tt>: it&#8217;s also fairly challenging to get its behavior right while going through configuration changes or the possibility of your activity being paused or destroyed while the task is still running.</p>
<p>Rx offers a few solutions to some of these problems, but not all.</p>
<h2>Threading and Rx</h2>
<p>Rx offers two methods to control your threading model: <tt>subscribeOn()</tt> and <tt>observeOn()</tt>.</p>
<p>In a nutshell, <tt>observeOn()</tt> defines what thread your observer will run on (this is where you usually do the work) and <tt>subscribeOn()</tt> defines the thread where your operators will run (<tt>map()</tt>, <tt>filter()</tt>, etc&#8230;).</p>
<p>The parameter you give to these methods is a <tt>Scheduler</tt>, an Rx abstraction that encapsulates a thread. Rx defines a few standard ones:</p>
<ul>
<li><tt>Schedulers.computation()</tt>: When you are calculating something.
<li><tt>Schedulers.io()</tt>: When you are doing I/O (network, file system, database access, &#8230;).
<li>And a few others I won&#8217;t get into here.
</ul>
<p>Additionally, RxAndroid defines the more Android-specific <tt>AndroidSchedulers.mainThread()</tt>, which is self explanatory.</p>
<p>A typical piece of code on Android is to run a few tasks in the background (network access, expensive computation, database update, etc&#8230;) and based on the result of that action, you update your UI. The way to implement this with Rx is straightforward: you subscribe on whichever background thread is more appropriate for your actions and you observe on the main thread:</p>
<pre class="brush: java">
trait Server {
    fun findUser(name: String) : Observable&lt;JsonObject&gt;
}

data class User(val id: String, val name: String)

fun p(s: String) {
    println("[${Thread.currentThread().getName()}] ${s}")
}

Observable.just("cedric")
    .subscribeOn(Schedulers.io())
    .flatMap {
    	p("Calling server.findUser");
    	server.findUser("cedric")
    }
    .map{jo ->
        p("Mapping to a User object")
    	User(jo.get("id").getAsString(),
             jo.get("name").getAsString())
     }
    .observeOn(AndroidSchedulers.mainThread())
    .subscribe{ u -> p("User: ${u}a") }
</pre>
<p>We start with a string (which could come from an <tt>EditText</tt> and we specify that we&#8217;ll be subscribing from the I/O thread. Then we call the server with that name (on the I/O thread), turn the JSON response into a <tt>User</tt> object and we print that object:</p>
<pre class="brush:plain">
[IoThreadScheduler-1] Calling server.findUser
[IoThreadScheduler-1] Mapping to a User object
[Main] User: User(id=123, name=cedric)
</pre>
<p>Note that even though you can specify multiple <tt>subscribeOn</tt>, all the subscriptions will happen on the first scheduler (subsequent <tt>subscribeOn</tt> will be ignored). I&#8217;m not sure if this is by design or just an oversight, but it&#8217;s not really a problem in practice. If you ever want to subscribe on multiple schedulers, you can always make this happen in the body of your subscription itself (for example, in the example above, if the server call was actually using Retrofit, you would see it&#8217;s using its own thread pool to make that call).</p>
<p>And that&#8217;s about all there is to get started with thread management with Rx on Android. As you can see, structuring your code this way makes the intent and thread handling extremely clear and easy to trace through, much more so than with <tt>AsyncTask</tt>.</p>
<p>With the growing number of Android libraries adding support for Rx, it&#8217;s becoming even more trivial to use these libraries within this framework and combine them in straightforward yet powerful ways. You can see in the examples I used in this post and the previous one how Rx makes it trivial to combine network calls and GUI updates simply by the fact that Retrofit returns Observables. You should also take a look at <a href="https://github.com/square/sqlbrite" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://github.com/square/sqlbrite', 'SQLBrite');">SQLBrite</tt></a>, which wraps <tt>SQLiteOpenHelper</tt> in Observables to offer you similar flexibility but for database access.</p>
<p>Read <a href="http://beust.com/weblog/2015/03/23/android-rx-and-kotlin-a-case-study/">part 1</a>, <a href="http://beust.com/weblog/2015/04/11/android-rx-and-kotlin-part-3/">part 3</a>.</p>
<div class="wp_plus_one_button" style="margin: 0 8px 8px 0; float:left; "><g:plusone href="http://beust.com/weblog/2015/04/05/android-rx-and-kotlin-part-2/" callback="wp_plus_one_handler"></g:plusone></div>
                    </div>

        </div>
        <!-- /post -->


       
        <!-- post -->
        <div id="post-2825" class="post-2825 post type-post status-publish format-standard hentry category-kotlin">

          <div class="post-header">
           <h3 class="post-title"><a href="http://beust.com/weblog/2015/03/30/2825/" rel="bookmark" title="Permanent Link: Kotlin Eclipse plug-in">Kotlin Eclipse plug-in</a></h3>
           <p class="post-date">
            <span class="month">Mar</span>
            <span class="day">30</span>
           </p>
           <p class="post-author">
            <span class="info">Posted by <a href="http://beust.com/weblog/author/admin/" title="Posts by Cedric ">Cedric</a> in <a href="http://beust.com/weblog/category/kotlin/" rel="category tag">Kotlin</a> | <span class="comments">Comments off</span>              </span>
           </p>
          </div>

          <div class="post-content clearfix">
          <p align="center">
  <img src="http://beust.com/pics/eclipse-kotlin.png" />
</p>
<p>JetBrains just released the first alpha version of the Kotlin Eclipse plug-in. The update site is:</p>
<pre>

https://teamcity.jetbrains.com/guestAuth/repository/download/Kotlin_EclipsePlugin/release.tcbuildtag/

</pre>
<p>You will need Luna to run it. It&#8217;s a bit rough around the edges, as you would expect from an Alpha, but it supports basic features:</p>
<ul>
<li>Problems view (I miss this so much on IDEA).
<li>Debugger.
<li>A few quick fixes (e.g. &#8220;Replace &#8216;get&#8217; with index operator).
<li>Testing.
<li>Auto imports.
<li>Navigate to symbol.
</ul>
<p>Hopefully the Eclipse plug-in will soon catch up to IDEA&#8217;s already awesome support for Kotlin.</p>
<div class="wp_plus_one_button" style="margin: 0 8px 8px 0; float:left; "><g:plusone href="http://beust.com/weblog/2015/03/30/2825/" callback="wp_plus_one_handler"></g:plusone></div>
                    </div>

        </div>
        <!-- /post -->


       
        <!-- post -->
        <div id="post-2791" class="post-2791 post type-post status-publish format-standard hentry category-android category-kotlin category-rx">

          <div class="post-header">
           <h3 class="post-title"><a href="http://beust.com/weblog/2015/03/23/android-rx-and-kotlin-a-case-study/" rel="bookmark" title="Permanent Link: Android, Rx and Kotlin: a case study">Android, Rx and Kotlin: a case study</a></h3>
           <p class="post-date">
            <span class="month">Mar</span>
            <span class="day">23</span>
           </p>
           <p class="post-author">
            <span class="info">Posted by <a href="http://beust.com/weblog/author/admin/" title="Posts by Cedric ">Cedric</a> in <a href="http://beust.com/weblog/category/android/" rel="category tag">Android</a>, <a href="http://beust.com/weblog/category/kotlin/" rel="category tag">Kotlin</a>, <a href="http://beust.com/weblog/category/rx/" rel="category tag">Rx</a> | <a href="http://beust.com/weblog/2015/03/23/android-rx-and-kotlin-a-case-study/#comments" class="comments"  title="Comment on Android, Rx and Kotlin: a case study">7 Comments</a>              </span>
           </p>
          </div>

          <div class="post-content clearfix">
          <p align="center">
  <video autoplay="true" loop="true"><source src="http://beust.com/pics/rx.mp4"/></video>
</p>
<p>There are countless introductions to Rx and quite a few discussing Rx on Android, so instead of writing another one, I decided to come up with a simple activity and go through the entire exercise of implementing it using Rx and Kotlin. I&#8217;m sure you&#8217;ll be able to follow these article easily even if you&#8217;re not familiar with Kotlin because the syntax is remarkably similar to what you would write if you were using Java 8 (just with fewer semi colons).</p>
<h2>The activity</h2>
<p>It&#8217;s shown at the top of this article. It&#8217;s pretty simple while covering some important basics and, as we&#8217;ll find out along the way, the devil is in the details. Here is a simple functional specification of this activity:</p>
<ul>
<li> The user types a nick name in an <tt>EditText</tt>. The activity asks the server if such a name is known and if it is, it returns a user record.</li>
<li> At this point, the user can &#8220;Add&#8221; this person as a friend, which triggers another call to the server to verify that the addition is allowed. The server returns a simple &#8220;ok&#8221; or &#8220;error&#8221; if that person can&#8217;t be added as a friend.</li>
</ul>
<p>A few additional details:</p>
<ul>
<li>We want to display a progress bar during all server calls.</li>
<li>Since we don&#8217;t want to bother the server too much, we only start sending requests for names that have three or more characters (we&#8217;ll add to this condition later).</li>
</ul>
<h2>Without Rx</h2>
<p>Implementing this activity with &#8220;regular&#8221; Android practices is straightforward:</p>
<ul>
<li>Add a listener to the <tt>EditText</tt> so we get notified each time a character is typed.</li>
<li>Send a network request with an <tt>AsyncTask</tt>.
<li>When the result comes, update the UI (on the main thread and not in whatever thread <tt>AsyncTask</tt> ended up running).
<li>Enable the &#8220;Add friend&#8221; button and listen to it, calling the server if pressed to verify that the friend can be added (one more <tt>AsyncTask</tt> + main thread post tap dance).
</ul>
<p>This implementation is straightforward but it&#8217;s very scattered. You will very likely end up with a lot of empty methods added just to satisfy listener requirements, storing state in fields to communicate between the various asynchronous tasks and making sure your threading model is sound. In other words, a lot of boiler plate, a messy mix of headless and graphical logic and graphical update code spread a bit everywhere.</p>
<p>There is a better way.</p>
<h2>Kotlin and Android</h2>
<p>I found Kotlin to be a very good match for Android even in the early days but recently, the Kotlin team has really cranked up their support for Android and adding specific functionalities for the platform in their tooling, which makes Kotlin even more of a perfect match for Android.</p>
<p>Kotlin M11 was released about a week ago and it added a functionality that makes the appeal of Kotlin absolutely irresistible for Android: automatically bound resources. Here is how it works.</p>
<p>Suppose you define the following View in your layout <tt>activity_search.xml</tt>:</p>
<pre class="brush:xml">
&lt;Button ...
    android:id="@+id/addFriendButton"
&gt;
</pre>
<p>All you need to do is add a special kind of import to your source:</p>
<pre class="brush:xml">
import kotlinx.android.synthetic.activity_search.addFriendButton
</pre>
<p>and the identifier <tt>addFriendButton</tt> becomes magically available everywhere in your source, with the proper type. This basically obsoletes <tt>ButterKnife/KotterKnife</tt> (well, not quite, there&#8217;s still <tt>OnClick</tt> which is pretty nice. Besides, Jake tells me he has something in the works). And if you press <tt>Ctrl-b</tt> on such an identifier, Android Studio takes you directly to the layout file where that View is defined. Very neat.</p>
<h2>The server</h2>
<p>For the purpose of this article, I&#8217;m just mocking the server. Here is its definition:</p>
<pre class="brush:java">
trait Server {
    fun findUser(name: String) : Observable&lt;JsonObject&gt;
    fun addFriend(user: User) : Observable&lt;JsonObject&gt;
}
</pre>
<p>If you think this definition looks a lot like a <a href="http://square.github.io/retrofit/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://square.github.io/retrofit/', 'Retrofit');">Retrofit</a> service interface, it&#8217;s because it is. If you&#8217;re not using Retrofit, you should. Right now, I&#8217;ll be mocking this server by returning a set of hardcoded answers and also making each call sleep one second to simulate latency (and so we can see the progress bar on the screen). Note that each call on this interface returns an <tt>Observable</tt>, so they fit right in with our Rx implementation.</p>
<p>In this example, I hardcoded the server to know about two friends (&#8220;cedric&#8221; and &#8220;jon&#8221;) but only &#8220;cedric&#8221; can be added as a friend.</p>
<h2>The Rx mindset</h2>
<p>Switching to the Rx mindset requires you to start thinking in terms of event sources (observables) and listeners (subscribers). If this idea doesn&#8217;t sound that novel, it&#8217;s because it&#8217;s not. This model was already being advocated in the book &#8220;Design Patterns&#8221; in 1994 and even in the early versions of Java twenty years ago (and no doubt you can find traces of it in the literature before that). However, Rx introduces new concepts in this idea that we&#8217;ll explore in this series.</p>
<p>So let&#8217;s rethink our activity in Rx terms: what are event sources (I&#8217;ll use the name &#8220;observable&#8221; from now on) in this activity?</p>
<p>I can count four observables:</p>
<ol>
<li>First, we have the <tt>EditText</tt>: whenever a new character is typed, it emits an event that contains the entire text typed so far. We can emit a new name once we have more than three characters.
<li>Next is the name observable, which calls the server and emits the JsonObject it receives in response.
<li>Next in the chain, we have a &#8220;user&#8221; Observable, which maps the JsonObject into a <tt>User</tt> instance with the name and id of that person.
<li>Finally, the &#8220;Add friend&#8221; button is another observable: if the user presses that button, we make another call to the server with the <tt>User</tt> we have and we update our UI based on the results.
</ol>
<p>There are various ways we can break this problem into observables and the final result depends on how you want to handle various tasks, which observables you want to reuse, the threading model you prefer, etc&#8230;</p>
<h2>Implementation</h2>
<h3>The &#8220;EditText&#8221; Observable</h3>
<p>Let&#8217;s start with our <tt>EditText</tt>. Its implementation is pretty straightforward:</p>
<pre class="brush:plain">
WidgetObservable.text(editText)
    .doOnNext { e: OnTextChangeEvent ->
        addFriendButton.setEnabled(false)
        loading.setVisibility(View.INVISIBLE)
    }
    .map { e: OnTextChangeEvent -> e.text().toString() }
    .filter { s: String -> s.length() >= 3 }
    .subscribe { s: String -> mNameObservable.onNext(s) }
</pre>
<p>Let&#8217;s go through each line in turn:</p>
<ul>
<li><tt>WidgetObservable</tt> turns an ordinary <tt>View</tt> into an <tt>Observable</tt>. It&#8217;s a wrapper coming from RxAndroid that calls all subscribers with the full text whenever a new character is typed.</li>
<li>Next we reset the UI to its default state.</li>
<li>The <tt>map</tt> line converts an <tt>OnTextChangeEvent</tt> into a string. It&#8217;s a purely convenience step, so that the next operators in the chain can deal with the context of the <tt>EditText</tt> as a String instead of having to repeatedly extract it from the event (<tt>e.text().toString()</tt> everywhere).
<li>Next, if the text is less than three characters long, we stop right there.</tt>
<li>Finally, we subscribe to the value we have obtained if we have reached this far: a string that&#8217;s at least three characters long. We pass this string to our name observable.
</ul>
<h3>The &#8220;name&#8221; Observable</h3>
<pre class="brush:java">
val mNameObservable: BehaviorSubject&lt;String&gt; = BehaviorSubject.create()
</pre>
<p>A <tt>BehaviorSubject</tt> is a special kind of <tt>Observable</tt> that you can send events to after its creation. I like to think of it as an event bus, except that it&#8217;s focused on a very specific kind of events (as opposed to an event bus that is used to post pretty much anything to). Using a <tt>Subject</tt> here allows me to create that <tt>Observable</tt> early and only post new events to it as they come in, which is what we did with the snippet of code above.</p>
<p>Let&#8217;s see how we use that <tt>Observable</tt> now, by simply subscribing to it, which means receiving names that have three or more characters in them. All we do is call the server and pass the result to the &#8220;user&#8221; observable:</p>
<pre class="brush:plain">
mNameObservable
    .subscribe{ s: String ->
        mServer.findUser(s).subscribe { jo: JsonObject ->
            mUserObservable.onNext(jo)
        }
    }
</pre>
<p>We&#8217;re not quite done, though: we actually have another subscriber to that <tt>Observable</tt>:</p>
<pre class="brush:plain">
mNameObservable
    .subscribe { s: String ->
        loading.setVisibility(View.VISIBLE)
    }
</pre>
<p>We need to let the user know we just issued a network call, so we show the progress bar (this is a suboptimal implementation, this logic should be done at the server level, but we&#8217;ll save this for later).</p>
<p>Note that I&#8217;m intentionally hiding a very important part of this logic in order to stay focused on the topic, and this also explains why we have two separate subscriptions. I explain why at the end of this article.</p>
<h3>The &#8220;User&#8221; Observable</h3>
<p>Next, we have the <tt>User</tt> Observable, which gets notified when the server sends us a response to the query &#8220;Does the user named &#8216;foo&#8217; exist?&#8221;:</p>
<pre class="brush:java">
mUserObservable
    .map { jo: JsonObject ->
        if (mServer.isOk(jo)) {
            User(jo.get("id").getAsString(), jo.get("name").getAsString())
        } else {
            null
        }
    }
    .subscribe { user: User? ->
        addFriendButton.setEnabled(user != null)
        loading.setVisibility(View.INVISIBLE)
        mUser = user
    }
</pre>
<p>This <tt>Observable</tt> does two things: it updates our UI and it maps the JsonObject response to our data class <tt>User</tt>. If the call was a success, we assign this value to the field <tt>mUser</tt>.</p>
<h3>The &#8220;Add friend&#8221; Observable</h3>
<p>Finally, we have the &#8220;Add friend&#8221; button, which only gets enabled once we have a valid <tt>User</tt>. If the user presses that button, we issue another call to the server to request that person to be added as a friend and then we update the UI depending on the response:</p>
<pre class="brush:java">
ViewObservable.clicks(addFriendButton)
    .subscribe { e: OnClickEvent ->
        mServer.addFriend(mUser!!)
            .subscribe { jo: JsonObject ->
                val toastText: String
                if (mServer.isOk(jo)) {
                    toastText = "Friend added id: " + jo.get("id").getAsString()
                    editText.setText("")
                } else {
                    toastText = "ERROR: Friend not added"
                }
                Toast.makeText(this, toastText, Toast.LENGTH_LONG).show();
            }
    }
</pre>
<h2>Stepping back</h2>
<p>This is a very different implementation of how you would write the code with regular Android calls, but in the end, it&#8217;s not just compact but it also divides our entire logic in four very distinct components that interact with each other in very clear ways. This is the macro level. At the micro level, these four components are not just self contained, they are also highly configurable thanks to operators, operations you can insert between your Observable and your Subscriber and which transform the data in ways that are easier for you to handle. I only have one such example of this in the code above (transforming an <tt>OnTextChangeEvent</tt> into a <tt>String</tt>) but you get the idea.</p>
<p>Another benefit that should be immediately obvious to you even if you don&#8217;t buy into the whole Rx paradigm shift yet is that thanks to Rx, we now have a universal language for observables and observers. I&#8217;m sure that right now, your Android code base contains a lot of such interfaces, all with subtly different method names and definitions and all needing some adapaters to be inserted before they can talk to each other. If ever you felt the need to write an interface with a method called <tt>"onSomethingHappened()</tt>&#8220;, Rx will be an immediate improvement.</p>
<h3>Operators</h3>
<p>I have barely touched upon operators and this topic in itself is worthy of an entire book but I&#8217;d like to spend a few minutes to give a quick example of the power of operators.</p>
<p>Going back to our activity, remember that as soon as the user types more than three characters, we send a query to the network for each character typed. This is a bit wasteful: a lot of phone users are very fast typists and if they type letters in quick succession, we could be sparing our server some extra work. For example, how about we define that we only call the server when the user stopped typing?</p>
<p>How do we define &#8220;stopped typing&#8221;? Let&#8217;s say that we&#8217;ll decide that the user stopped typing if two keypresses are separated by more than 500ms. This way, a quick typing of &#8220;cedric&#8221; will result in just one server call instead of four without this function. How do we go about implementing this?</p>
<p>Again, the traditional approach would mean that each time our text change listener is invoked, we compare the current time with the timestamp of the last character typed and if it exceeds a certain value, we trigger the event.</p>
<p>As it turns out, observables have an operator that does this for us called <tt>debounce()</tt>, so our code becomes:</p>
<pre class="brush:plain; highlight: [8]">
WidgetObservable.text(editText)
    .doOnNext {(e: OnTextChangeEvent) ->
        addFriendButton.setEnabled(false)
        loading.setVisibility(View.INVISIBLE)
    }
    .map { e: OnTextChangeEvent -> e.text().toString() }
    .filter { s: String -> s.length() >= 3 }
    .debounce(500, TimeUnit.MILLISECONDS)
    .subscribe { s: String -> mNameObservable.onNext(s) }
</pre>
<p>I know what you&#8217;re thinking: &#8220;You just picked a problem that could be solved by an operator that already exists&#8221;. Well, kind of, but that&#8217;s not my point. First of all, this is not a made up problem and I&#8217;m sure a lot of developers who write user interface code will agree that this is pretty common.</p>
<p>However, my point is more general than this: the <tt>debounce()</tt> operator has nothing to do with Android. It is defined on <tt>Observable</tt>, which is the base library we are using. It&#8217;s an operator that&#8217;s generally useful to have on any source that emits events. These events might be graphical in nature (as is the case here) or of any other kind, such as a stream of network requests, coordinates of a mouse cursor or capturing data from a geolocation sensor. <tt>debounce()</tt> represents the general need for getting rid of redundancies in streams.</p>
<p>Not only do we get to reuse an existing implementation without having to rewrite it ourselves, we preserve the locality of our implementation (with the traditional approach, you would probably have polluted your class with a couple of fields) and we maintain the composition abilities of our observable computations. For example, do you need to make sure that the user is not adding themselves before calling the server? Easy:</p>
<pre class="brush:plain; highlight: [4]">
WidgetObservable.text(editText)
    // ...
    .filter { s: String -> s.length() >= 3 }
    .filter { s: String -> s != myName }
</pre>
<h2>Wrapping up</h2>
<p>At this point, you should probably take a look at <a href="https://github.com/cbeust/kotlin-android-example/blob/master/app/src/main/kotlin/com/beust/example/SearchActivity.kt" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://github.com/cbeust/kotlin-android-example/blob/master/app/src/main/kotlin/com/beust/example/SearchActivity.kt', 'the full source');">the full source</a> so you can step back and see how all these pieces fit together. It&#8217;s obvious to me that the view of decomposing your problem in terms of observables that emit values that subscribers observe is extremely powerful and leads to cleaner, more self contained and composable code. The non-Rx version of this class feels incredibly messy to me (a lot more fields holding state, methods added just to satisfy slightly incompatible listener interfaces and a total lack of composability).</p>
<p>Having said that, our work here is not over:</p>
<ul>
<li>The threading model is all wrong. I intentionally omitted any thread consideration in this article in order to stay on topic but the code as it is right now is extremely suboptimal. It works but you shouldn&#8217;t ship it in its current form. In the next installment, I will show how Rx makes it trivial to get Android&#8217;s multithreaded model right.</li>
<li>There is a lot of UI code peppered through the business logic. It&#8217;s messy, it obfuscates how our UI works and it&#8217;s hard to maintain. We&#8217;ll have to fix that as well.
</ul>
<p>Stay tuned!</p>
<p><em>Update: Discussion on <a href="http://www.reddit.com/r/androiddev/comments/305k8o/android_rx_and_kotlin_a_case_study/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.reddit.com/r/androiddev/comments/305k8o/android_rx_and_kotlin_a_case_study/', 'reddit');">reddit</a>.</em></p>
<p>Read <a href="http://beust.com/weblog/2015/04/05/android-rx-and-kotlin-part-2/">part 2</a>.</p>
<div class="wp_plus_one_button" style="margin: 0 8px 8px 0; float:left; "><g:plusone href="http://beust.com/weblog/2015/03/23/android-rx-and-kotlin-a-case-study/" callback="wp_plus_one_handler"></g:plusone></div>
                    </div>

        </div>
        <!-- /post -->


       
        <!-- post -->
        <div id="post-2781" class="post-2781 post type-post status-publish format-standard hentry category-general">

          <div class="post-header">
           <h3 class="post-title"><a href="http://beust.com/weblog/2014/12/19/new-comments-a-chrome-extension-for-reddit-and-hacker-news/" rel="bookmark" title="Permanent Link: &#8220;New Comments&#8221;: A Chrome extension for reddit and Hacker News">&#8220;New Comments&#8221;: A Chrome extension for reddit and Hacker News</a></h3>
           <p class="post-date">
            <span class="month">Dec</span>
            <span class="day">19</span>
           </p>
           <p class="post-author">
            <span class="info">Posted by <a href="http://beust.com/weblog/author/admin/" title="Posts by Cedric ">Cedric</a> in <a href="http://beust.com/weblog/category/general/" rel="category tag">General</a> | <span class="comments">Comments off</span>              </span>
           </p>
          </div>

          <div class="post-content clearfix">
          <p align="center">
	<a href="https://chrome.google.com/webstore/detail/new-comments/jldpfbgmbdnnjdgohphppjnpadogdime"><br />
	  <img width="90%" src="http://beust.com/pics/new-comments.png"/><br />
	</a>
</p>
<p>I recently became tired of how awkward following discussions on Hacker News and reddit is so I decided to write a Chrome extension to address the problem. The result is <a href="https://chrome.google.com/webstore/detail/new-comments/jldpfbgmbdnnjdgohphppjnpadogdime" onclick="__gaTracker('send', 'event', 'outbound-article', 'https://chrome.google.com/webstore/detail/new-comments/jldpfbgmbdnnjdgohphppjnpadogdime', '&#8220;New Comments&#8221;');">&#8220;New Comments&#8221;</a>.</p>
<p>This extension will trigger only on Hacker News and reddit. When you read a comment thread on either of these sites, the extension will compare the current time with the last time you refreshed it, locate all the new comments and highlight them. If you enabled Chrome sync, the extension will work across all your computers so that you can start reading a discussion on your laptop and keep reading it later on your desktop with only the correct new comments highlighted.</p>
<p>Some of the lessons I learned in the process:</p>
<ul>
<li>Writing a Chrome extension is ridiculously easy and the debugger is top notch.
<li>Chrome&#8217;s storage API makes it trivial to build on top of Chrome sync.
<li>Javascript is productive but still frustrating because of its lack of types. Even when the code was just a handful of functions, I was already beginning to hit bugs coming from the absence of the type system. I used the debugger as a substitute for types way too often.
<li>Following this, I realized that my inclination to refactor and polish the code was considerably lessened. The code is pretty ugly as it is, with string literals splattered a bit everywhere and a questionable module structure, but once it was working, I didn&#8217;t feel the urge to make it perfect that I usually feel with a statically typed language and a powerful IDE under my fingers.
</ul>
<p>If you read Hacker News or Reddit and you&#8217;d like to optimize your time spent on these sites, try New Comments and let me know what you think!</p>
<p>
<div class="wp_plus_one_button" style="margin: 0 8px 8px 0; float:left; "><g:plusone href="http://beust.com/weblog/2014/12/19/new-comments-a-chrome-extension-for-reddit-and-hacker-news/" callback="wp_plus_one_handler"></g:plusone></div>
                    </div>

        </div>
        <!-- /post -->


       
        <!-- post -->
        <div id="post-2771" class="post-2771 post type-post status-publish format-standard hentry category-general">

          <div class="post-header">
           <h3 class="post-title"><a href="http://beust.com/weblog/2014/07/13/a-rubiks-cube-implementation-in-three-js/" rel="bookmark" title="Permanent Link: A Rubik&#8217;s cube implementation in Three.js">A Rubik&#8217;s cube implementation in Three.js</a></h3>
           <p class="post-date">
            <span class="month">Jul</span>
            <span class="day">13</span>
           </p>
           <p class="post-author">
            <span class="info">Posted by <a href="http://beust.com/weblog/author/admin/" title="Posts by Cedric ">Cedric</a> in <a href="http://beust.com/weblog/category/general/" rel="category tag">General</a> | <a href="http://beust.com/weblog/2014/07/13/a-rubiks-cube-implementation-in-three-js/#comments" class="comments"  title="Comment on A Rubik&#8217;s cube implementation in Three.js">1 Comment</a>              </span>
           </p>
          </div>

          <div class="post-content clearfix">
          <p align="center">
	<a href="http://beust.com/rubik"><br />
		<img src="http://beust.com/pics/rubik.png" /><br />
	</a>
</p>
<p>In 2003, I took the time to put together a page that explains how to solve the Rubik&#8217;s cube with a set of formulas that are easy to memorize. The idea was not necessarily to solve the cube quickly (it takes about 50-60 seconds to solve the cube with this approach) but to make it easy for anyone to beat the cube with little effort, as opposed to the hundreds of formulas that speed cubists have to memorize to remain competitive.</p>
<p>Back then, I used a Java applet that represents a cube with formulas and then playing these formulas to explain to the reader how exactly they work. As everybody knows, Java applets have fallen out of favor even more today than they already were ten years ago, so I&#8217;ve been wanting to update my page with more modern technologies for a while, especially if these technologies don&#8217;t show a scary warning to everyone who reaches my web site.</p>
<p>I finally took the time to update my page and I reimplemented the entire cube animation in Javascript with Three.js. <a href="http://beust.com/rubik">Here is how it looks like today</a>.</p>
<p>While it&#8217;s easy to find rapidly implemented Rubik&#8217;s cubes in <a href="http://threejs.org/" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://threejs.org/', 'Three.js');">Three.js</a>, I couldn&#8217;t find anything that came remotely close to what I needed, namely, being able to configure a cube directly from the HTML page along with the formula, and playing this formula at the click of a button. Three.js turned out to be a great match for this, with the perfect amount of abstraction and power. And with Three.js came a few free bonus tools, such as being able to move the cube around and also effortlessly zooming in and out. Of course, it&#8217;s equally trivial to modify the size of the cube, the position of the camera, the field of view, and just as easy to add more fancy stuff such as lighting, shadows and fancy materials.</p>
<p>The implementation is open source but I want to write some proper documentation before publishing it.</p>
<p>Overall, the experience was fairly pleasant. My relationship with Javascript is stormy at times (I&#8217;m planning to rewrite this in Dart at some point to compare) but in the end, using both IDEA and Eclipse to write the code (switching between both to compare) and with the Chrome debugger in a separate window, the productivity level is pretty high.</p>
<p>Implementing the cube itself was the most interesting part: there are so many ways you can model a Rubik&#8217;s cube that such a problem is a software designer&#8217;s dream. I must have had three different iterations of the data model before I settled on the version you see now (and I&#8217;m already thinking of ways I could improve it).</p>
<p>Three.js has come a long way since I gave it a try two years ago. The web is still filled with incorrect information referencing an old API that has since then changed, but it&#8217;s very intuitive and, most importantly, it allowed me to completely avoid having to deal with the WebGL madness. I don&#8217;t know if it&#8217;s my brain that&#8217;s just not wired for this, but I have tried to read countless OpenGL tutorials over the past years and every time, I give up after an hour, my eyes glazing over the intricate, effect-littered, abstraction empty details of OpenGL. The API is probably too low level for someone like me with just a passing interest for gory graphical details.</p>
<p>My knowledge of computer graphics and animation is abysmal overall, so this was a great opportunity to move  myself out of my comfort zone and force myself to confront problems that I usually never encounter, such as finding tricks to counter floating point rounding errors and revising matrix multiplications and other miscellaneous linear algebra and 3D geometry concepts such as <a href="http://en.wikipedia.org/wiki/Quaternion" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://en.wikipedia.org/wiki/Quaternion', 'quaternions');">quaternions</a> and <a href="http://en.wikipedia.org/wiki/Gimbal_lock" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://en.wikipedia.org/wiki/Gimbal_lock', 'gimbal locks');">gimbal locks</a>.</p>
<p>
<div class="wp_plus_one_button" style="margin: 0 8px 8px 0; float:left; "><g:plusone href="http://beust.com/weblog/2014/07/13/a-rubiks-cube-implementation-in-three-js/" callback="wp_plus_one_handler"></g:plusone></div>
                    </div>

        </div>
        <!-- /post -->


       
        <!-- post -->
        <div id="post-2764" class="post-2764 post type-post status-publish format-standard hentry category-general">

          <div class="post-header">
           <h3 class="post-title"><a href="http://beust.com/weblog/2014/06/02/swift-apples-new-language/" rel="bookmark" title="Permanent Link: Swift, Apple&#8217;s new language">Swift, Apple&#8217;s new language</a></h3>
           <p class="post-date">
            <span class="month">Jun</span>
            <span class="day">2</span>
           </p>
           <p class="post-author">
            <span class="info">Posted by <a href="http://beust.com/weblog/author/admin/" title="Posts by Cedric ">Cedric</a> in <a href="http://beust.com/weblog/category/general/" rel="category tag">General</a> | <a href="http://beust.com/weblog/2014/06/02/swift-apples-new-language/#comments" class="comments"  title="Comment on Swift, Apple&#8217;s new language">16 Comments</a>              </span>
           </p>
          </div>

          <div class="post-content clearfix">
          <p>Apple just announced a new language called Swift. I took a look at the language manual, here is a quick overview:</p>
<ul>
<li>Statically typed with type inference.
<li>Generics.
<li>Closures.
<li>No exceptions.
<li>Extension methods.
<li>Properties (syntax similar to C#), including lazy properties with the <tt>"@lazy"</tt> annotation.
<li>Functions, methods and type (static) methods.
<li>Support for observers (with <tt>"willSet"</tt> and <tt>"didSet"</tt>). Interesting to see the observer pattern baked in a language although I&#8217;m more partial to event buses for this kind of thing.
<li>Enums.
<li>Classes and structures (structures have restrictions regarding inheritance and other things).
<li>For and while loops (statements, not expressions).
<li><tt>"mutating"</tt> keyword.
<li>Named parameters.
<li>Deinitializers (finalizers).
<li>Protocols (interfaces).
<li>Optional chaining with <tt>"a?.b?.c"</tt> and forced dereference with <tt>"!."</tt>&#8220;.
<li>Convenient &#8220;assign and test&#8221;: <tt>"if let person = findPerson() ..."</tt>.
<li>Type casting with <tt>"is"</tt>, down casting with <tt>"as?"</tt> (combines nicely with the <tt>"let"</tt> syntax. Ceylon does it right too).
</ul>
<p>Very interesting overall, and a clear step up from Objective C. From the feature set, I would say the language that Swift has the most overlap with is Kotlin, which is great news for Apple developers.</p>
<p><em>Update: <a href="http://www.reddit.com/r/programming/comments/274t5s/apple_swift_programming_language_unveiled/chxgtfh" onclick="__gaTracker('send', 'event', 'outbound-article', 'http://www.reddit.com/r/programming/comments/274t5s/apple_swift_programming_language_unveiled/chxgtfh', 'discussion on reddit');">discussion on reddit</a></em>.</p>
<div class="wp_plus_one_button" style="margin: 0 8px 8px 0; float:left; "><g:plusone href="http://beust.com/weblog/2014/06/02/swift-apples-new-language/" callback="wp_plus_one_handler"></g:plusone></div>
                    </div>

        </div>
        <!-- /post -->


       
       <div class="navigation" id="pagenavi">
               <div class="alignleft"><a href="http://beust.com/weblog/page/2/" >&laquo; Older Entries</a></div>
        <div class="alignright"></div>
        <div class="clear"></div>
              </div>
       
      </div>
     </div>
     <!-- /first column -->
     
<!-- 2nd column (sidebar) -->
<div class="col2">
 <ul id="sidebar">

    
    
    <li class="block widget widget_text" id="text-4"><div class="box"> <div class="wrapleft"><div class="wrapright"><div class="tr"><div class="bl"><div class="tl"><div class="br the-content"><div class="titlewrap"><h4><span>Welcome</span></h4></div>			<div class="textwidget">My name is Cdric Beust. I am a software engineer and the creator of the <a href="http://testng.org" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://testng.org', 'Java testing framework TestNG');">Java testing framework TestNG</a>.  If you like this blog, you should follow me on <a href="http://twitter.com/cbeust" onclick="__gaTracker('send', 'event', 'outbound-widget', 'http://twitter.com/cbeust', 'twitter');">twitter</a> or on <a href="https://plus.google.com/u/0/108840253750748459271/posts" onclick="__gaTracker('send', 'event', 'outbound-widget', 'https://plus.google.com/u/0/108840253750748459271/posts', 'Google+');">Google+</a>. You can also email me at <a href="mailto:cedric@beust.com" onclick="__gaTracker('send', 'event', 'mailto', 'cedric@beust.com');">cedric@beust.com</a>.
</div>
		</div></div></div></div></div></div> </div></li><li class="block widget widget_links" id="linkcat-14"><div class="box"> <div class="wrapleft"><div class="wrapright"><div class="tr"><div class="bl"><div class="tl"><div class="br the-content"><div class="titlewrap"><h4><span>Top entries</span></h4></div>
	<ul class='xoxo blogroll'>
<li><a href="http://beust.com/weblog/2006/06/07/agile-people-still-dont-get-it/">Agile people still don&#039;t get it</a></li>
<li><a href="http://beust.com/weblog/2008/06/27/" title="A simple coding problem, hundreds of possible solutions">Coding challenge</a></li>
<li><a href="http://beust.com/weblog/2008/08/28/coding-challenge-wrap-up/" title="An overview of the solutions to the coding challenge">Coding challenge wrap-up</a></li>
<li><a href="http://beust.com/weblog/2006/07/04/confessions-of-a-reluctant-switcher/">Confessions of a reluctant switcher</a></li>
<li><a href="http://beust.com/weblog/2006/10/01/dynamic-language-refactoring-ide-pick-one/" title="Some automatic refactorings are impossible to achieve with dynamically typed languages">Dynamic language, refactoring: pick one</a></li>
<li><a href="http://beust.com/weblog/2009/11/28/hard-core-multicore-with-testng/">Hardcore multicore with TestNG</a></li>
<li><a href="http://beust.com/weblog/2009/12/13/more-on-multithreaded-topological-sorting-2/">Hardcore multicore with TestNG (2)</a></li>
<li><a href="http://beust.com/weblog/2004/02/08/junit-pain/">JUnit pain</a></li>
<li><a href="http://beust.com/weblog/2008/02/11/structural-typing-vs-duck-typing/">Structural typing vs duck typing</a></li>
<li><a href="http://beust.com/weblog/2005/12/15/the-fan-syndrome/">The Fan Syndrome</a></li>
<li><a href="http://beust.com/weblog/2005/04/15/the-perils-of-duck-typing/">The perils of duck typing</a></li>
<li><a href="http://beust.com/weblog/2008/05/12/return-of-the-statically-typed-languages/">The return of statically typed languages</a></li>
<li><a href="http://beust.com/weblog/2004/09/16/why-i-love-ruby/">Why I love Ruby</a></li>
<li><a href="http://beust.com/weblog/2006/04/06/why-ruby-on-rails-wont-become-mainstream/">Why Ruby on Rails won&#039;t become mainstream</a></li>

	</ul>
</div></div></div></div></div></div> </div></li>
		<li class="block widget widget_recent_entries" id="recent-posts-3"><div class="box"> <div class="wrapleft"><div class="wrapright"><div class="tr"><div class="bl"><div class="tl"><div class="br the-content">		<div class="titlewrap"><h4><span>Recent posts</span></h4></div>		<ul>
					<li>
				<a href="http://beust.com/weblog/2015/05/12/anko-for-android/">Anko for Android</a>
						</li>
					<li>
				<a href="http://beust.com/weblog/2015/05/03/the-case-of-the-buggy-executor/">The case of the buggy executor</a>
						</li>
					<li>
				<a href="http://beust.com/weblog/2015/05/02/your-code-doesnt-speak-for-itself/">Your code doesn&#8217;t speak for itself</a>
						</li>
					<li>
				<a href="http://beust.com/weblog/2015/04/11/android-rx-and-kotlin-part-3/">Android, Rx and Kotlin: part 3</a>
						</li>
					<li>
				<a href="http://beust.com/weblog/2015/04/05/android-rx-and-kotlin-part-2/">Android, Rx and Kotlin: part 2</a>
						</li>
					<li>
				<a href="http://beust.com/weblog/2015/03/30/2825/">Kotlin Eclipse plug-in</a>
						</li>
					<li>
				<a href="http://beust.com/weblog/2015/03/23/android-rx-and-kotlin-a-case-study/">Android, Rx and Kotlin: a case study</a>
						</li>
					<li>
				<a href="http://beust.com/weblog/2014/12/19/new-comments-a-chrome-extension-for-reddit-and-hacker-news/">&#8220;New Comments&#8221;: A Chrome extension for reddit and Hacker News</a>
						</li>
					<li>
				<a href="http://beust.com/weblog/2014/07/13/a-rubiks-cube-implementation-in-three-js/">A Rubik&#8217;s cube implementation in Three.js</a>
						</li>
					<li>
				<a href="http://beust.com/weblog/2014/06/02/swift-apples-new-language/">Swift, Apple&#8217;s new language</a>
						</li>
					<li>
				<a href="http://beust.com/weblog/2014/05/24/coding-challenge-partial-results-semantics/">Coding challenge: partial results semantics</a>
						</li>
					<li>
				<a href="http://beust.com/weblog/2014/05/11/more-about-language-popularity/">More about language popularity</a>
						</li>
					<li>
				<a href="http://beust.com/weblog/2014/05/11/the-pitfalls-of-test-driven-development/">The pitfalls of Test-Driven Development</a>
						</li>
					<li>
				<a href="http://beust.com/weblog/2014/05/03/language-popularity-on-github/">Language popularity on GitHub</a>
						</li>
					<li>
				<a href="http://beust.com/weblog/2014/05/01/a-bit-i-cant-unsee/">A bit I can&#8217;t unsee</a>
						</li>
				</ul>
		</div></div></div></div></div></div> </div></li><li class="block widget widget_archive" id="archives-4"><div class="box"> <div class="wrapleft"><div class="wrapright"><div class="tr"><div class="bl"><div class="tl"><div class="br the-content"><div class="titlewrap"><h4><span>Archives</span></h4></div>		<ul>
	<li><a href='http://beust.com/weblog/2015/05/'>May 2015</a>&nbsp;(3)</li>
	<li><a href='http://beust.com/weblog/2015/04/'>April 2015</a>&nbsp;(2)</li>
	<li><a href='http://beust.com/weblog/2015/03/'>March 2015</a>&nbsp;(2)</li>
	<li><a href='http://beust.com/weblog/2014/12/'>December 2014</a>&nbsp;(1)</li>
	<li><a href='http://beust.com/weblog/2014/07/'>July 2014</a>&nbsp;(1)</li>
	<li><a href='http://beust.com/weblog/2014/06/'>June 2014</a>&nbsp;(1)</li>
	<li><a href='http://beust.com/weblog/2014/05/'>May 2014</a>&nbsp;(5)</li>
	<li><a href='http://beust.com/weblog/2014/01/'>January 2014</a>&nbsp;(1)</li>
	<li><a href='http://beust.com/weblog/2013/08/'>August 2013</a>&nbsp;(3)</li>
	<li><a href='http://beust.com/weblog/2013/07/'>July 2013</a>&nbsp;(2)</li>
	<li><a href='http://beust.com/weblog/2013/03/'>March 2013</a>&nbsp;(2)</li>
	<li><a href='http://beust.com/weblog/2013/02/'>February 2013</a>&nbsp;(2)</li>
	<li><a href='http://beust.com/weblog/2013/01/'>January 2013</a>&nbsp;(2)</li>
	<li><a href='http://beust.com/weblog/2012/12/'>December 2012</a>&nbsp;(1)</li>
	<li><a href='http://beust.com/weblog/2012/09/'>September 2012</a>&nbsp;(1)</li>
	<li><a href='http://beust.com/weblog/2012/08/'>August 2012</a>&nbsp;(2)</li>
	<li><a href='http://beust.com/weblog/2012/07/'>July 2012</a>&nbsp;(1)</li>
	<li><a href='http://beust.com/weblog/2012/06/'>June 2012</a>&nbsp;(1)</li>
	<li><a href='http://beust.com/weblog/2012/04/'>April 2012</a>&nbsp;(1)</li>
	<li><a href='http://beust.com/weblog/2012/03/'>March 2012</a>&nbsp;(4)</li>
	<li><a href='http://beust.com/weblog/2012/02/'>February 2012</a>&nbsp;(3)</li>
	<li><a href='http://beust.com/weblog/2012/01/'>January 2012</a>&nbsp;(1)</li>
	<li><a href='http://beust.com/weblog/2011/12/'>December 2011</a>&nbsp;(2)</li>
	<li><a href='http://beust.com/weblog/2011/11/'>November 2011</a>&nbsp;(3)</li>
	<li><a href='http://beust.com/weblog/2011/10/'>October 2011</a>&nbsp;(7)</li>
	<li><a href='http://beust.com/weblog/2011/09/'>September 2011</a>&nbsp;(2)</li>
	<li><a href='http://beust.com/weblog/2011/08/'>August 2011</a>&nbsp;(10)</li>
	<li><a href='http://beust.com/weblog/2011/07/'>July 2011</a>&nbsp;(8)</li>
	<li><a href='http://beust.com/weblog/2011/06/'>June 2011</a>&nbsp;(2)</li>
	<li><a href='http://beust.com/weblog/2011/05/'>May 2011</a>&nbsp;(7)</li>
	<li><a href='http://beust.com/weblog/2011/04/'>April 2011</a>&nbsp;(2)</li>
	<li><a href='http://beust.com/weblog/2011/03/'>March 2011</a>&nbsp;(7)</li>
	<li><a href='http://beust.com/weblog/2011/02/'>February 2011</a>&nbsp;(4)</li>
	<li><a href='http://beust.com/weblog/2011/01/'>January 2011</a>&nbsp;(6)</li>
	<li><a href='http://beust.com/weblog/2010/12/'>December 2010</a>&nbsp;(8)</li>
	<li><a href='http://beust.com/weblog/2010/11/'>November 2010</a>&nbsp;(2)</li>
	<li><a href='http://beust.com/weblog/2010/10/'>October 2010</a>&nbsp;(1)</li>
	<li><a href='http://beust.com/weblog/2010/09/'>September 2010</a>&nbsp;(4)</li>
	<li><a href='http://beust.com/weblog/2010/08/'>August 2010</a>&nbsp;(12)</li>
	<li><a href='http://beust.com/weblog/2010/07/'>July 2010</a>&nbsp;(9)</li>
	<li><a href='http://beust.com/weblog/2010/06/'>June 2010</a>&nbsp;(5)</li>
	<li><a href='http://beust.com/weblog/2010/05/'>May 2010</a>&nbsp;(7)</li>
	<li><a href='http://beust.com/weblog/2010/04/'>April 2010</a>&nbsp;(7)</li>
	<li><a href='http://beust.com/weblog/2010/03/'>March 2010</a>&nbsp;(8)</li>
	<li><a href='http://beust.com/weblog/2010/02/'>February 2010</a>&nbsp;(2)</li>
	<li><a href='http://beust.com/weblog/2010/01/'>January 2010</a>&nbsp;(2)</li>
	<li><a href='http://beust.com/weblog/2009/12/'>December 2009</a>&nbsp;(1)</li>
	<li><a href='http://beust.com/weblog/2009/11/'>November 2009</a>&nbsp;(4)</li>
	<li><a href='http://beust.com/weblog/2009/10/'>October 2009</a>&nbsp;(1)</li>
	<li><a href='http://beust.com/weblog/2009/09/'>September 2009</a>&nbsp;(2)</li>
	<li><a href='http://beust.com/weblog/2009/08/'>August 2009</a>&nbsp;(1)</li>
	<li><a href='http://beust.com/weblog/2009/07/'>July 2009</a>&nbsp;(2)</li>
	<li><a href='http://beust.com/weblog/2009/06/'>June 2009</a>&nbsp;(1)</li>
	<li><a href='http://beust.com/weblog/2009/04/'>April 2009</a>&nbsp;(4)</li>
	<li><a href='http://beust.com/weblog/2009/03/'>March 2009</a>&nbsp;(4)</li>
	<li><a href='http://beust.com/weblog/2009/02/'>February 2009</a>&nbsp;(1)</li>
	<li><a href='http://beust.com/weblog/2008/11/'>November 2008</a>&nbsp;(3)</li>
	<li><a href='http://beust.com/weblog/2008/10/'>October 2008</a>&nbsp;(4)</li>
	<li><a href='http://beust.com/weblog/2008/09/'>September 2008</a>&nbsp;(3)</li>
	<li><a href='http://beust.com/weblog/2008/08/'>August 2008</a>&nbsp;(1)</li>
	<li><a href='http://beust.com/weblog/2008/07/'>July 2008</a>&nbsp;(1)</li>
	<li><a href='http://beust.com/weblog/2008/06/'>June 2008</a>&nbsp;(4)</li>
	<li><a href='http://beust.com/weblog/2008/05/'>May 2008</a>&nbsp;(6)</li>
	<li><a href='http://beust.com/weblog/2008/04/'>April 2008</a>&nbsp;(1)</li>
	<li><a href='http://beust.com/weblog/2008/03/'>March 2008</a>&nbsp;(3)</li>
	<li><a href='http://beust.com/weblog/2008/02/'>February 2008</a>&nbsp;(1)</li>
	<li><a href='http://beust.com/weblog/2008/01/'>January 2008</a>&nbsp;(5)</li>
	<li><a href='http://beust.com/weblog/2007/11/'>November 2007</a>&nbsp;(3)</li>
	<li><a href='http://beust.com/weblog/2007/10/'>October 2007</a>&nbsp;(3)</li>
	<li><a href='http://beust.com/weblog/2007/09/'>September 2007</a>&nbsp;(5)</li>
	<li><a href='http://beust.com/weblog/2007/08/'>August 2007</a>&nbsp;(2)</li>
	<li><a href='http://beust.com/weblog/2007/07/'>July 2007</a>&nbsp;(3)</li>
	<li><a href='http://beust.com/weblog/2007/06/'>June 2007</a>&nbsp;(2)</li>
	<li><a href='http://beust.com/weblog/2007/05/'>May 2007</a>&nbsp;(5)</li>
	<li><a href='http://beust.com/weblog/2007/04/'>April 2007</a>&nbsp;(3)</li>
	<li><a href='http://beust.com/weblog/2007/03/'>March 2007</a>&nbsp;(4)</li>
	<li><a href='http://beust.com/weblog/2007/02/'>February 2007</a>&nbsp;(2)</li>
	<li><a href='http://beust.com/weblog/2007/01/'>January 2007</a>&nbsp;(6)</li>
	<li><a href='http://beust.com/weblog/2006/12/'>December 2006</a>&nbsp;(4)</li>
	<li><a href='http://beust.com/weblog/2006/11/'>November 2006</a>&nbsp;(3)</li>
	<li><a href='http://beust.com/weblog/2006/10/'>October 2006</a>&nbsp;(7)</li>
	<li><a href='http://beust.com/weblog/2006/09/'>September 2006</a>&nbsp;(2)</li>
	<li><a href='http://beust.com/weblog/2006/08/'>August 2006</a>&nbsp;(7)</li>
	<li><a href='http://beust.com/weblog/2006/07/'>July 2006</a>&nbsp;(9)</li>
	<li><a href='http://beust.com/weblog/2006/06/'>June 2006</a>&nbsp;(3)</li>
	<li><a href='http://beust.com/weblog/2006/05/'>May 2006</a>&nbsp;(5)</li>
	<li><a href='http://beust.com/weblog/2006/04/'>April 2006</a>&nbsp;(6)</li>
	<li><a href='http://beust.com/weblog/2006/03/'>March 2006</a>&nbsp;(7)</li>
	<li><a href='http://beust.com/weblog/2006/02/'>February 2006</a>&nbsp;(11)</li>
	<li><a href='http://beust.com/weblog/2006/01/'>January 2006</a>&nbsp;(7)</li>
	<li><a href='http://beust.com/weblog/2005/12/'>December 2005</a>&nbsp;(9)</li>
	<li><a href='http://beust.com/weblog/2005/11/'>November 2005</a>&nbsp;(9)</li>
	<li><a href='http://beust.com/weblog/2005/10/'>October 2005</a>&nbsp;(7)</li>
	<li><a href='http://beust.com/weblog/2005/09/'>September 2005</a>&nbsp;(9)</li>
	<li><a href='http://beust.com/weblog/2005/08/'>August 2005</a>&nbsp;(9)</li>
	<li><a href='http://beust.com/weblog/2005/07/'>July 2005</a>&nbsp;(8)</li>
	<li><a href='http://beust.com/weblog/2005/06/'>June 2005</a>&nbsp;(10)</li>
	<li><a href='http://beust.com/weblog/2005/05/'>May 2005</a>&nbsp;(10)</li>
	<li><a href='http://beust.com/weblog/2005/04/'>April 2005</a>&nbsp;(12)</li>
	<li><a href='http://beust.com/weblog/2005/03/'>March 2005</a>&nbsp;(11)</li>
	<li><a href='http://beust.com/weblog/2005/02/'>February 2005</a>&nbsp;(16)</li>
	<li><a href='http://beust.com/weblog/2005/01/'>January 2005</a>&nbsp;(12)</li>
	<li><a href='http://beust.com/weblog/2004/12/'>December 2004</a>&nbsp;(9)</li>
	<li><a href='http://beust.com/weblog/2004/11/'>November 2004</a>&nbsp;(9)</li>
	<li><a href='http://beust.com/weblog/2004/10/'>October 2004</a>&nbsp;(12)</li>
	<li><a href='http://beust.com/weblog/2004/09/'>September 2004</a>&nbsp;(14)</li>
	<li><a href='http://beust.com/weblog/2004/08/'>August 2004</a>&nbsp;(15)</li>
	<li><a href='http://beust.com/weblog/2004/07/'>July 2004</a>&nbsp;(15)</li>
	<li><a href='http://beust.com/weblog/2004/06/'>June 2004</a>&nbsp;(12)</li>
	<li><a href='http://beust.com/weblog/2004/05/'>May 2004</a>&nbsp;(12)</li>
	<li><a href='http://beust.com/weblog/2004/04/'>April 2004</a>&nbsp;(14)</li>
	<li><a href='http://beust.com/weblog/2004/03/'>March 2004</a>&nbsp;(20)</li>
	<li><a href='http://beust.com/weblog/2004/02/'>February 2004</a>&nbsp;(9)</li>
	<li><a href='http://beust.com/weblog/2004/01/'>January 2004</a>&nbsp;(16)</li>
	<li><a href='http://beust.com/weblog/2003/12/'>December 2003</a>&nbsp;(9)</li>
	<li><a href='http://beust.com/weblog/2003/11/'>November 2003</a>&nbsp;(9)</li>
	<li><a href='http://beust.com/weblog/2003/10/'>October 2003</a>&nbsp;(11)</li>
	<li><a href='http://beust.com/weblog/2003/09/'>September 2003</a>&nbsp;(13)</li>
	<li><a href='http://beust.com/weblog/2003/08/'>August 2003</a>&nbsp;(16)</li>
		</ul>
</div></div></div></div></div></div> </div></li><li class="block widget widget_meta" id="meta-3"><div class="box"> <div class="wrapleft"><div class="wrapright"><div class="tr"><div class="bl"><div class="tl"><div class="br the-content"><div class="titlewrap"><h4><span>Meta</span></h4></div>			<ul>
						<li><a href="http://beust.com/weblog/wp-login.php">Log in</a></li>
			<li><a href="http://beust.com/weblog/feed/">Entries <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="http://beust.com/weblog/comments/feed/">Comments <abbr title="Really Simple Syndication">RSS</abbr></a></li>
<li><a href="https://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress.org</a></li>			</ul>
</div></div></div></div></div></div> </div></li> </ul>
</div>
<!-- /2nd column -->
     
    </div>
   </div>
   <div class="clear-content"></div>
  </div>
  <!-- /main page block -->

 </div>
</div>
<!-- /main wrappers -->


 <!-- footer -->
 <div id="footer">

  <!-- page block -->
  <div class="block-content">

    
    
    <div class="copyright">
     <p>
     <!-- please do not remove this. respect the authors :) -->
     Arclite theme by <a href="http://digitalnature.ro">digitalnature</a> | powered by <a href="http://wordpress.org/">WordPress</a>     </p>
     <p>
     <a class="rss" href="http://beust.com/weblog/feed/">Entries (RSS)</a> and <a href="http://beust.com/weblog/comments/feed/">Comments (RSS)</a> <a href="javascript:void(0);" class="toplink">TOP</a>
     <!-- 23 queries. 0.608 seconds. -->
     </p>
    </div>

  </div>
  <!-- /page block -->

 </div>
 <!-- /footer -->

</div>
<!-- /page -->

  <script type="text/javascript">
  /* <![CDATA[ */
    var isIE6 = false; /* <- do not change! */
    var isIE = false; /* <- do not change! */
    var lightbox = 0;/* <- do not change! */
  /* ]]> */
  </script>
  <!--[if lte IE 6]> <script type="text/javascript"> isIE6 = true; isIE = true; </script> <![endif]-->
  <!--[if gte IE 7]> <script type="text/javascript"> isIE = true; </script> <![endif]-->


	<script type="text/javascript">
	  window.___gcfg = {lang: 'en'};
	
	  (function() {
	    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
	    po.src = 'https://apis.google.com/js/plusone.js';
	    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
	  })();
	</script></body>
</html>


<!-- Dynamic page generated in 0.597 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2015-05-20 10:57:57 -->

<!-- super cache -->

